{% load static %}
<!doctype html>
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="csrf-token" content="{{ csrf_token }}">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<meta name="author" content="Untree.co">
	<link rel="shortcut icon" href="favicon.png">

	<meta name="description" content="" />
	<meta name="keywords" content="bootstrap, bootstrap5" />
	
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Brygada+1918:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@400;700&display=swap" rel="stylesheet">

	<link rel="stylesheet" href="{% static 'fonts/icomoon/style.css'%}">
	<link rel="stylesheet" href="{% static 'fonts/flaticon/font/flaticon.css'%}">

	<link rel="stylesheet" href="{% static 'css/tiny-slider.css'%}">
	<link rel="stylesheet" href="{% static 'css/aos.css'%}">
	<link rel="stylesheet" href="{% static 'css/flatpickr.min.css'%}">
	<link rel="stylesheet" href="{% static 'css/glightbox.min.css'%}">
	<link rel="stylesheet" href="{% static 'css/style.css'%}">
  <style>
    .dropdown {
      position: relative;
    }
    
    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background-color: white;
      border: 1px solid #ccc;
      z-index: 1000;
      max-height: 200px;
      overflow-y: auto;
      display: none; /* 기본적으로 숨김 */
    }
    
    .dropdown-menu .dropdown-item {
      padding: 8px 12px;
      cursor: pointer;
    }
    
    .dropdown-menu .dropdown-item:hover {
      background-color: #f0f0f0;
    }
  </style>
  <title>KOAT - 코리아트레블</title>

	<script src="http://code.jquery.com/jquery-latest.min.js"></script>

</head>
<body>

	<input type="hidden" id="csrf_token" value="{{ csrf_token }}">

	<div class="site-mobile-menu site-navbar-target">
		<div class="site-mobile-menu-header">
			<div class="site-mobile-menu-close">
				<span class="icofont-close js-menu-toggle"></span>
			</div>
		</div>
		<div class="site-mobile-menu-body"></div>
	</div>

	<nav class="site-nav mt-3">
		<div class="container">

			<div class="site-navigation">
				<div class="row">
					<div class="col-6 col-lg-3">
						<a href="/" class="logo m-0 float-start">KOAT</a>
					</div>
					<div class="col-lg-6 d-none d-lg-inline-block text-center nav-center-wrap">
						<ul class="js-clone-nav  text-center site-menu p-0 m-0">
							<li class="active"><a href="/">Home</a></li>
							<li class="has-children">
								<a href="#">지역/즐길거리</a>
								<ul class="dropdown">
									<li><a href="/location/location">지역</a></li>
									<li class="has-children">
										<a href="#">즐길거리</a>
										<ul class="dropdown">
											<li><a href="/food/eat/">한국 대표 음식</a></li>
											<li><a href="#">한국 문화 유산</a></li>
										</ul>
									</li>
									<li><a href="#">Menu Three</a></li>
								</ul>
							</li>
							<li><a href="/board/blist/">게시판</a></li>
              <li><a href="/package/plist">패키지</a></li>
								{% if request.session.session_m_auth == 0%}
									<li><a href="/admin/">admin</a></li>
								{% else %}
								{% endif %}
						</ul>
					</div>
					<div class="col-6 col-lg-3 text-lg-end">
						<ul class="js-clone-nav d-none d-lg-inline-block text-end site-menu ">
							{% if not request.session.session_m_id %}
							<li class="cta-button"><a href="/member/login/">로그인</a></li>
							{% else %}
							<li class="cta-button"><a href="/member/logout/">로그아웃</a></li>
							{% endif %}
						</ul>

						<a href="#" class="burger ms-auto float-end site-menu-toggle js-menu-toggle d-inline-block d-lg-none light" data-toggle="collapse" data-target="#main-navbar">
							<span></span>
						</a>
					</div>
				</div>
			</div>
			
		</div>
	</nav>

	<!--사이드 바-->
	<div id="right_fixed">
		<div class="ai_chatting"></div>
		<div class="top"><a href="javascript:void(0);" onclick="openSmallWindow('/chatbot/bot/')">SKYNET과 대화</a></div>
	</div>
	<!--사이드 바-->
	<script>
	// 사이드바 자바스크립트
		function openSmallWindow(url) {
			window.open(url, 'AIChatWindow', 'width=470,height=900');
		}
		const video = document.getElementById('backvd');
		const controlBtn = document.getElementById('vdcont');
	// 사이드바 자바스크립트
	</script>
  <!--헤더-->	
  <div class="hero overlay">
		<div class="img-bg rellax">
			<img src="/static/images/package/package_image.webp" alt="Image" class="img-fluid">
		</div>
		<div class="container">
			<div class="row align-items-center justify-content-start">
				<div class="col-lg-6 mx-auto text-center">

					<h1 class="heading" data-aos="fade-up">Hotel</h1>
					<p class="mb-4" data-aos="fade-up" style="font-size: 30px;">현지의 예약 가능한 호텔 중 KOAT가 엄선한 호텔을 알려드립니다.</p>

					<div data-aos="fade-up">
            <a href="https://www.agoda.com/ko-kr/?cid=1844104&ds=ZSDqvtarS5VJu5HZ" target="_blank" style="font-weight: 600; color: azure;">
							<div class="d-inline-flex align-items-center ">
								<span class="icon-button me-3">
									<span class="icon-play"></span>
								</span>
								<span class="caption">예약 사이트로 이동</span>
							</div>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>

  <!-- 호텔 데이터 -->
  <div class="section">
    <div class="container">
  
      <div class="col-12">
        <form action="{% url 'shop:hotels' %}" method="post" name="hotels">
          {% comment %} <input type="text" id="hotelInput" class="form-control" placeholder="도시, 체크인 날짜, 체크아웃 날짜, 방 개수, 어른 명수, 아이 명수 ex)서울(14690),2024-12-19,2024-12-24,1,2,0">
        </br> {% endcomment %}
          <div class="dropdown">
          <input type="text" id="cityInput" class="form-control" placeholder="도시를 입력하세요" autocomplete="off" readonly>
            <ul id="cityList" class="dropdown-menu" style="display: none;">   
              <li class="dropdown-item">서울</li>
              <li class="dropdown-item">부산</li>
              <li class="dropdown-item">제주</li>
              <li class="dropdown-item">대구</li>
              <li class="dropdown-item">광주</li>
            </ul>
          </div>
          <br/>
          <input type="button" id="hotelBtn" value="Search" class="btn btn-primary dpchk">
        </form>
      </div>
      <br>
  
      <div class="row flex-container" id="hotel_list">
        <!-- 여기에 호텔 데이터가 추가됩니다 -->
      </div>
    </div>
  </div>

  <script>
    $(document).ready(function() {
      $("#hotelBtn").off('click').on('click', function() {
        loadHotelData();
      function getCSRFToken() {
        return $('#csrf_token').val();
      }
  
      function loadHotelData() {
        const inputData = $("#hotelInput").val();
        const hotelList = $("#hotel_list");
        hotelList.innerHTML = '<p>로딩 중...</p>'; // 로딩 메시지 추가
        
        // const [cityName, checkIn, checkOut, rooms, adults, children] = inputData.split(',').map(x => x.trim());
        const cityInput = document.getElementById("cityInput");
        const cityList = document.getElementById("cityList");
        
        cityInput.addEventListener("click", function () {
          cityList.style.display = "block";
        });
        
        cityList.addEventListener("click", function (event) {
          if (event.target && event.target.matches(".dropdown-item")) {
            const cityName = event.target.textContent; // 선택한 도시 이름
            cityInput.value = cityName; // input에 도시 이름 반영
            cityList.style.display = "none"; // 드롭다운 숨김
      
            // 체크인/체크아웃 등 추가 정보 (임시 값)
            const checkIn = "2025-01-09"; // 체크인 날짜
            const checkOut = "2025-01-12"; // 체크아웃 날짜
            const rooms = 1; // 방 개수
            const adults = 2; // 성인 수
            const children = 0; // 아이 수

        fetch('/shop/api/hotels/', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCSRFToken() // CSRF 토큰 추가
            // 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36'
          },
          body: JSON.stringify({
            city_name: cityName,
            check_in: checkIn,
            check_out: checkOut,
            rooms: rooms,
            adults: adults,
            children: children
          })
        })
        .then(response => {
          if (!response.ok) {
            return response.text().then(text => { throw new Error(`에러 발생: ${text}`); });
          }
          return response.json();
        })
        .then(data => {
          hotelList.html(''); // 기존 데이터를 지우기
          if (!data.data.length) {
              // 조건에 부합하는 호텔이 없는 경우
              hotelList.html('<h2 style="color: gray;">조건에 부합하는 호텔이 없습니다.</h2>');
              return; // 더 이상 아래 코드를 실행하지 않음
          }
          if (data.status === 'error') {
            throw new Error(data.message);
          }	
          
          data.data.forEach((hotel, index) => {
            const div = document.createElement('div');
            div.classList.add('col-6', 'col-sm-6', 'col-md-6', 'col-lg-3', 'mb-4');
            div.innerHTML = `
            <div class="media-entry">
                          <img src="${hotel.hlink}" alt="Image" class="img-fluid" style="width: 260px; height: 190px;">
                          <div class="bg-white m-body">
                            <h3><a>${hotel.name}</a></h3>
                            <p>${hotel.cost}₩</p>
                            </div>
                            </div>
                `;
                hotelList.append(div);
              });
            })
            .catch(error => {
              hotelList.innerHTML = `<p>에러 발생: ${error.message}</p>`;
              console.error('에러 발생:', error);
            });
          }
      });
      
      // 드롭다운 외부 클릭 시 드롭다운 숨김
      document.addEventListener("click", function (event) {
        if (!cityList.contains(event.target) && event.target !== cityInput) {
          cityList.style.display = "none";
        }
      });
    
      }
    }); 
  });//제이쿼리

  </script>

  <!-- 호텔 데이터 -->

  <!-- Footer 부분 -->

	<div class="site-footer">
		<div class="container">

			<div class="row">

				<div class="col-lg-2 ml-auto">
					<div class="widget">
						<h3>유용한 링크</h3>
						<ul class="list-unstyled float-left links">
							<li><a href="https://www.skyscanner.co.kr/">비행기 예매</a></li>
							<li><a href="https://www.kobus.co.kr/main.do">버스 예매</a></li>
							<li><a href="https://www.mibankins.com/travel/">여행자 보험</a></li>
							<li><a href="https://www.weather.go.kr/w/index.do">한국 날씨</a></li>
							<li><a href="#">Q&A</a></li>
						</ul>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-3 -->

				<div class="col-lg-2">
					<div class="widget">
						<h3>사이트 기능</h3>
						<ul class="list-unstyled float-left links">
							<li><a href="#">About us</a></li>
							<li><a href="#">Services</a></li>
							<li><a href="#">News</a></li>
							<li><a href="#">Careers</a></li>
							<li><a href="#">Contact</a></li>
						</ul>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-3 -->


				<div class="col-lg-3">
					<div class="widget">
						<h3>회사 주소</h3>
						<address>	101, Gasan digital 2-ro, Geumcheon-gu, Seoul, Republic of Korea</address>
						<ul class="list-unstyled links mb-4">
							<li><a href="tel://11234567890">Tel : +82(02)-2025-8523</a></li>
							<li><a href="tel://11234567890">Fax : +82(02)-2101-2154</a></li>
							<li><a href="mailto:info@mydomain.com">kosmo@ikosmo.co.kr</a></li>
						</ul>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-3 -->

				<div class="col-lg-4">
					<div class="widget">
						<h3>연락</h3>
						<ul class="list-unstyled social icoct">
							<li><a href="https://www.instagram.com/kto9suk9suk"><span class="icon-instagram"></span></a></li>
							<li><a href="https://x.com/kor_visitkorea"><span class="icon-twitter"></span></a></li>
							<li><a href="https://www.facebook.com/welcometoKTO"><span class="icon-facebook"></span></a></li>
							<li><a href="https://open.spotify.com/track/1IlMgzxAtjoNUPUmp8Omki?si=3d0feb86bdc54c9b"><span class="icon-spotify"></span></a></li>
							<li><a href="#"><span class="icon-pinterest"></span></a></li>
							<li><a href="#"><span class="icon-dribbble"></span></a></li>
						</ul>
					</div> <!-- /.widget -->
					{% comment %} <div class="widget">
						<h3>About Passport<span class="text-primary">.</span> </h3>
						<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts.</p>
					</div> <!-- /.widget -->
				</div> <!-- /.col-lg-3 --> {% endcomment %}

			</div> <!-- /.row -->

			<div class="row mt-5">
				<div class="col-12 text-center">
					<p class="mb-0">Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co">Untree.co</a> <!-- License information: https://untree.co/license/ -->
					</p>
				</div>
			</div> <!-- /.container -->
		</div> <!-- /.site-footer -->

		<!-- Preloader -->
		<div id="overlayer"></div>
		<div class="loader">
			<div class="spinner-border text-primary" role="status">
				<span class="visually-hidden">Loading...</span>
			</div>
		</div>


		<script src="{% static 'js/bootstrap.bundle.min.js'%}"></script>
		<script src="{% static 'js/tiny-slider.js'%}"></script>
		<script src="{% static 'js/aos.js'%}"></script>
		<script src="{% static 'js/navbar.js'%}"></script>
		<script src="{% static 'js/counter.js'%}"></script>
		<script src="{% static 'js/rellax.js'%}"></script>
		<script src="{% static 'js/flatpickr.js'%}"></script>
		<script src="{% static 'js/glightbox.min.js'%}"></script>
		<script src="{% static 'js/custom.js'%}"></script>
	</body>
	</html>